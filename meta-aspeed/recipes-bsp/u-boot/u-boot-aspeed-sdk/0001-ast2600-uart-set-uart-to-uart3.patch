From 848f902f879ee791e341fe113913419a9f44a2d4 Mon Sep 17 00:00:00 2001
From: Jian Zhang <zhangjian.3032@bytedance.com>
Date: Sat, 22 Oct 2022 02:09:25 +0800
Subject: [PATCH] ast2600: uart: set uart to uart3

Signed-off-by: Jian Zhang <zhangjian.3032@bytedance.com>
---
 arch/arm/dts/ast2600-evb.dts          | 20 +++++++-------------
 configs/ast2600_openbmc_spl_defconfig |  2 +-
 2 files changed, 8 insertions(+), 14 deletions(-)

diff --git a/arch/arm/dts/ast2600-evb.dts b/arch/arm/dts/ast2600-evb.dts
index 6db1efdda5..b22323f563 100644
--- a/arch/arm/dts/ast2600-evb.dts
+++ b/arch/arm/dts/ast2600-evb.dts
@@ -12,7 +12,8 @@
 	};
 
 	chosen {
-		stdout-path = &uart5;
+		// stdout-path = &uart5;
+		stdout-path = &uart3;
 	};
 
 	aliases {
@@ -43,6 +44,11 @@
 	status = "okay";
 };
 
+&uart3 {
+	u-boot,dm-pre-reloc;
+	status = "okay";
+};
+
 &sdrammc {
 	clock-frequency = <400000000>;
 };
@@ -77,10 +83,6 @@
 	ethphy2: ethernet-phy@2 {
 		reg = <0>;
 	};
-
-	ethphy3: ethernet-phy@3 {
-		reg = <0>;
-	};
 };
 
 &mac0 {
@@ -107,14 +109,6 @@
 	pinctrl-0 = <&pinctrl_rgmii3_default>;
 };
 
-&mac3 {
-	status = "okay";
-	phy-mode = "rgmii";
-	phy-handle = <&ethphy3>;
-	pinctrl-names = "default";
-	pinctrl-0 = <&pinctrl_rgmii4_default>;
-};
-
 &fmc {
 	status = "okay";
 
diff --git a/configs/ast2600_openbmc_spl_defconfig b/configs/ast2600_openbmc_spl_defconfig
index 95d7651b8e..1d0ddb1c90 100644
--- a/configs/ast2600_openbmc_spl_defconfig
+++ b/configs/ast2600_openbmc_spl_defconfig
@@ -28,7 +28,7 @@ CONFIG_FIT_SIGNATURE=y
 CONFIG_SPL_FIT_SIGNATURE=y
 CONFIG_SPL_LOAD_FIT=y
 CONFIG_USE_BOOTARGS=y
-CONFIG_BOOTARGS="console=ttyS4,115200n8 root=/dev/ram rw"
+CONFIG_BOOTARGS="console=ttyS2,115200n8 root=/dev/ram rw"
 CONFIG_USE_BOOTCOMMAND=y
 CONFIG_BOOTCOMMAND="run bootspi"
 CONFIG_SYS_CONSOLE_ENV_OVERWRITE=y
-- 
2.25.1

